(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[846],{9991:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/submissions",function(){return e(8962)}])},8962:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return r}});var i=e(5893),a=e(7294),s=e(9008),c=e.n(s),o=e(5748),d=e.n(o);function r(){let[t,n]=(0,a.useState)([]),[e,s]=(0,a.useState)([]),[o,r]=(0,a.useState)(!0),[l,m]=(0,a.useState)(null),[h,_]=(0,a.useState)("api");(0,a.useEffect)(()=>{let t=async()=>{try{let t=await fetch("/api/submissions");if(!t.ok)throw Error("无法获取API提交数据");let e=await t.json();n(e.data||[])}catch(t){m("无法加载API提交数据，请稍后再试")}},e=()=>{try{let t=JSON.parse(localStorage.getItem("contactFormSubmissions")||"[]");s(t)}catch(t){m("无法加载本地提交数据")}};(async()=>{r(!0),await t(),e(),r(!1)})()},[]);let u=async()=>{r(!0),m(null);try{let t=await fetch("/api/submissions");if(!t.ok)throw Error("无法获取API提交数据");let e=await t.json();n(e.data||[]);{let t=JSON.parse(localStorage.getItem("contactFormSubmissions")||"[]");s(t)}}catch(t){m("刷新数据时出错，请稍后再试")}r(!1)},j=async t=>{if(confirm("确定要清除".concat("api"===t?"API":"本地","提交数据吗？此操作不可撤销。"))){if(r(!0),"api"===t)try{if(!(await fetch("/api/submissions",{method:"DELETE"})).ok)throw Error("清除API数据失败");n([])}catch(t){m("清除API数据时出错")}else"local"===t&&(localStorage.removeItem("contactFormSubmissions"),s([]));r(!1)}},x=t=>{try{return new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(n){return t||"未知"}},b=t=>0===t.length?(0,i.jsx)("p",{className:d().noData,children:"暂无提交数据"}):(0,i.jsx)("div",{className:d().submissionsTable,children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"ID"}),(0,i.jsx)("th",{children:"姓名"}),(0,i.jsx)("th",{children:"邮箱"}),(0,i.jsx)("th",{children:"电话"}),(0,i.jsx)("th",{children:"主题"}),(0,i.jsx)("th",{children:"消息"}),(0,i.jsx)("th",{children:"提交时间"})]})}),(0,i.jsx)("tbody",{children:t.map((t,n)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:t.id||n+1}),(0,i.jsx)("td",{children:t.name}),(0,i.jsx)("td",{children:t.email}),(0,i.jsx)("td",{children:t.phone}),(0,i.jsx)("td",{children:t.subject}),(0,i.jsx)("td",{className:d().messageCell,children:(0,i.jsx)("div",{className:d().messageContent,children:t.message})}),(0,i.jsx)("td",{children:x(t.timestamp||t.submitTime)})]},t.id||t.submitTime||n))})]})});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(c(),{children:[(0,i.jsx)("title",{children:"表单提交管理 - CCIE培训"}),(0,i.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,i.jsxs)("div",{className:d().adminContainer,children:[(0,i.jsxs)("div",{className:d().adminHeader,children:[(0,i.jsx)("h1",{children:"表单提交管理"}),(0,i.jsxs)("div",{className:d().adminActions,children:[(0,i.jsx)("button",{onClick:u,className:d().actionButton,disabled:o,children:"刷新数据"}),(0,i.jsxs)("button",{onClick:()=>j(h),className:"".concat(d().actionButton," ").concat(d().dangerButton),disabled:o,children:["清除","api"===h?"API":"本地","数据"]})]})]}),l&&(0,i.jsx)("div",{className:d().errorAlert,children:(0,i.jsx)("p",{children:l})}),(0,i.jsxs)("div",{className:d().tabContainer,children:[(0,i.jsxs)("div",{className:d().tabs,children:[(0,i.jsxs)("button",{className:"".concat(d().tabButton," ").concat("api"===h?d().activeTab:""),onClick:()=>_("api"),children:["API 提交数据 (",t.length,")"]}),(0,i.jsxs)("button",{className:"".concat(d().tabButton," ").concat("local"===h?d().activeTab:""),onClick:()=>_("local"),children:["本地存储数据 (",e.length,")"]})]}),(0,i.jsx)("div",{className:d().tabContent,children:o?(0,i.jsx)("div",{className:d().loading,children:"加载中..."}):(0,i.jsxs)(i.Fragment,{children:["api"===h&&b(t),"local"===h&&b(e)]})})]}),(0,i.jsxs)("div",{className:d().adminFooter,children:[(0,i.jsx)("p",{children:"注意：API数据在服务器重启后将会丢失，仅用于演示。实际应用中应使用数据库存储。"}),(0,i.jsx)("p",{children:"本地存储数据仅在当前浏览器中可见，不同设备无法共享查看。"})]})]})]})}},5748:function(t){t.exports={adminContainer:"Admin_adminContainer__fnIiy",adminHeader:"Admin_adminHeader__D8Awi",adminActions:"Admin_adminActions__b08c8",actionButton:"Admin_actionButton__UMz0P",dangerButton:"Admin_dangerButton__tTjXx",errorAlert:"Admin_errorAlert__L7Pjv",tabContainer:"Admin_tabContainer__bWLpU",tabs:"Admin_tabs__3vtz5",tabButton:"Admin_tabButton__z_6xx",activeTab:"Admin_activeTab__fvtdm",tabContent:"Admin_tabContent__0FbSA",loading:"Admin_loading__zO_FK",noData:"Admin_noData__UPaLV",submissionsTable:"Admin_submissionsTable__RZVau",messageCell:"Admin_messageCell__PVTXI",messageContent:"Admin_messageContent__h3ROz",adminFooter:"Admin_adminFooter__kgWi1"}}},function(t){t.O(0,[888,774,179],function(){return t(t.s=9991)}),_N_E=t.O()}]);